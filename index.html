import React, { useState, useEffect } from 'react';

// Main App component
const App = () => {
  // Initial project data
  const initialProjects = [
    {
      id: '1',
      title: 'Website Redesign',
      description: 'This project involves a complete overhaul of our existing company website. The goal is to improve user experience, update the visual design, and enhance mobile responsiveness. Key features include a new navigation system, updated content sections, and integration with our CRM system. The project will be executed in three phases: planning and wireframing, design and development, and testing and deployment. We aim to complete this project within six months.',
    },
    {
      id: '2',
      title: 'Mobile App Development',
      description: 'Development of a new mobile application for both iOS and Android platforms. The app will provide users with on-the-go access to our services, including real-time notifications and personalized content. We will use React Native for cross-platform compatibility. The project phases include concept validation, UI/UX design, front-end and back-end development, and rigorous testing. Expected completion is eight months.',
    },
    {
      id: '3',
      title: 'Data Analytics Platform',
      description: 'Building a robust daata analytics platform to process and visualize large datasets. This platform will enable our business intelligence team to gain deeper insights into customer behavior and market trends. Technologies involved include Python, Apache Spark, and Tableau. The project will focus on data ingestion, processing pipelines, and interactive dashboards. This is a critical infrastructure project with a projected timeline of one year.',
    },
    {
      id: '4',
      title: 'Internal Tool Automation',
      description: 'Automating several manual internal processes to increase efficiency and reduce human error. This includes automating report generation, data entry, and inter-departmental communication workflows. We will leverage scripting languages and API integrations. The aim is to free up employee time for more strategic tasks. This project is expected to deliver tangible results within four months.',
    },
  ];

  // State to hold all projects
  const [projects, setProjects] = useState(initialProjects);
  // State to hold the ID of the currently selected project
  const [currentProjectId, setCurrentProjectId] = useState(initialProjects[0].id);
  // State to hold the title of the currently selected project for editing
  const [currentProjectTitle, setCurrentProjectTitle] = useState(initialProjects[0].title);
  // State to hold the description of the currently selected project for editing
  const [currentProjectDescription, setCurrentProjectDescription] = useState(initialProjects[0].description);
  // State to manage loading status for potential future API calls
  const [loading, setLoading] = useState(false);
  // State for success/error messages
  const [message, setMessage] = useState('');

  // Effect to update current project details when currentProjectId changes
  useEffect(() => {
    const selectedProject = projects.find(proj => proj.id === currentProjectId);
    if (selectedProject) {
      setCurrentProjectTitle(selectedProject.title);
      setCurrentProjectDescription(selectedProject.description);
      setMessage(''); // Clear message when switching projects
    }
  }, [currentProjectId, projects]); // Depend on currentProjectId and projects

  // Function to handle saving changes to a project
  const handleSave = () => {
    setLoading(true);
    setMessage('');

    // Simulate an async save operation
    setTimeout(() => {
      setProjects(prevProjects =>
        prevProjects.map(proj =>
          proj.id === currentProjectId
            ? { ...proj, title: currentProjectTitle, description: currentProjectDescription }
            : proj
        )
      );
      setLoading(false);
      setMessage('Project saved successfully!');
      // Clear message after a few seconds
      setTimeout(() => setMessage(''), 3000);
    }, 500); // Simulate network delay
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8 font-inter antialiased">
      {/* Tailwind CSS CDN */}
      <script src="https://cdn.tailwindcss.com"></script>
      {/* Inter font from Google Fonts */}
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

      <style>{`
        body {
          font-family: 'Inter', sans-serif;
        }
      `}</style>

      <div className="max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden md:flex">
        {/* Sidebar for Project Navigation */}
        <nav className="w-full md:w-1/4 bg-gray-800 text-white p-4 md:p-6 flex flex-col rounded-l-xl">
          <h2 className="text-2xl font-bold mb-6 text-center">My Projects</h2>
          <ul className="space-y-3 flex-grow">
            {projects.map(project => (
              <li key={project.id}>
                <button
                  onClick={() => setCurrentProjectId(project.id)}
                  className={`block w-full text-left py-2 px-4 rounded-lg transition-all duration-200 ease-in-out
                    ${currentProjectId === project.id
                      ? 'bg-blue-600 text-white shadow-md'
                      : 'hover:bg-gray-700 hover:text-blue-300'
                    }`}
                >
                  {project.title}
                </button>
              </li>
            ))}
          </ul>
        </nav>

        {/* Main Content Area for Project Details */}
        <main className="w-full md:w-3/4 p-6 md:p-8 lg:p-10">
          <h1 className="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-6 border-b-2 pb-3 border-blue-200">
            Project Details
          </h1>

          {/* Message display */}
          {message && (
            <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
              <span className="block sm:inline">{message}</span>
            </div>
          )}

          {/* Project Title Input */}
          <div className="mb-6">
            <label htmlFor="projectTitle" className="block text-lg font-medium text-gray-700 mb-2">
              Project Title
            </label>
            <input
              type="text"
              id="projectTitle"
              className="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-base outline-none transition-all duration-200"
              value={currentProjectTitle}
              onChange={(e) => setCurrentProjectTitle(e.target.value)}
              placeholder="Enter project title"
            />
          </div>

          {/* Project Description Textarea */}
          <div className="mb-8">
            <label htmlFor="projectDescription" className="block text-lg font-medium text-gray-700 mb-2">
              Project Description
            </label>
            <textarea
              id="projectDescription"
              rows="10"
              className="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-base outline-none transition-all duration-200 resize-y"
              value={currentProjectDescription}
              onChange={(e) => setCurrentProjectDescription(e.target.value)}
              placeholder="Write your project description here..."
            ></textarea>
          </div>

          {/* Save Button */}
          <button
            onClick={handleSave}
            disabled={loading}
            className="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-300 ease-in-out
              disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
          >
            {loading ? (
              <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            ) : (
              'Save Project'
            )}
          </button>
        </main>
      </div>
    </div>
  );
};

export default App;
